{% load static %}
<link rel="icon" type="image/x-icon" href="{% static 'app/favicon.ico' %}">
<link rel="stylesheet" href="{% static 'app/css/header_style.css' %}">
<title>Заявки</title>
<div class="app-header">
    <div class="app-header-left">
        <svg viewBox="0 0 55 52" fill="none" xmlns="http://www.w3.org/2000/svg" width="40" height="40">
            <g clip-path="url(#clip0_916_25)">
                <path d="M47.7309 8.49474C41.7409 2.01474 32.2909 -1.07526 23.0809 0.414743C15.2009 1.60474 8.25092 6.20474 4.02092 13.0347C-0.0990806 19.6947 -1.10908 27.7047 1.25092 35.0147C3.39092 41.9247 8.64092 47.8147 15.3209 50.7847L15.8509 51.0247L16.6609 49.4247L16.1509 49.1347C11.1709 46.3247 7.38092 41.9047 5.48092 36.6847C2.29092 28.1847 4.74092 18.1047 11.4509 12.1747C16.6509 7.53474 23.1209 5.64474 29.6609 6.84474C36.5309 8.11474 42.4309 12.6147 45.8509 19.2047C50.1509 27.5247 48.8709 37.9047 42.5909 45.6547L42.2609 46.0547L43.3709 47.2947L43.8109 47.0247C48.5209 44.0747 52.1509 39.1547 53.7609 33.5447C56.3209 24.8647 53.9509 15.0247 47.7309 8.50474V8.49474Z" fill="#FE6E36"></path>
            </g>
            <defs>
                <clipPath id="clip0_916_25">
                    <rect width="54.77" height="50.97" fill="white" transform="translate(0 0.0449219)"></rect>
                </clipPath>
            </defs>
        </svg>
        <a href="/" class="app-name" style="text-decoration: none;">Solar ITILIUM</a>

    </div>
    <div class="app-header-right">
        {%if request.user.is_seach%}
        <form method="get" action="{% url 'Open_Ticket_Search' %}" class="form">
            <button type="submit">
                <svg width="17" height="16" fill="none" xmlns="http://www.w3.org/2000/svg" role="img" aria-labelledby="search">
                    <path d="M7.667 12.667A5.333 5.333 0 107.667 2a5.333 5.333 0 000 10.667zM14.334 14l-2.9-2.9" stroke="currentColor" stroke-width="1.333" stroke-linecap="round" stroke-linejoin="round"></path>
                </svg>
            </button>
            <input class="input" name="uuid" placeholder="№ Заявки" required type="text">
            <button class="reset" type="reset">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </form>
        {% endif %}

        <button id="openModalBtn" class="buttonnew" style="margin-left: 18px;margin-right: 18px;">


            <svg class="svgIcon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15"></path>
            </svg>

        </button>


        <div class="modal-overlay" id="modalOverlay2">
            <div class="modal" style="padding-left: 10px;padding-right: 10px;padding-bottom: 10px;padding-top: 10px;">
                <button class="buttonbell" id="closeModal2Btn" style="padding-top: 4px;padding-bottom: 4px;">
                    <svg class="bell" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="color: white;">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path>
                    </svg>


                </button>
                <h1 style="margin-left: 15px;">Список КЕ</h1>
                <table class="rwd-table">
                    <tbody>
                    </tbody>
                </table>
                <div class="custom-tooltip-container">
                    <a class="custom-tooltip-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                            <path fill-rule="evenodd" d="M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z" clip-rule="evenodd"></path>
                        </svg>

                    </a>
                    <div class="custom-tooltip-content">
                        <span class="custom-tooltip-arrow"></span>
                        <p class="custom-tooltip-text">Список КЕ может быть не полным! Уточнаяйте актуальный список у службы поддержки</p>
                    </div>
                </div>

            </div>
        </div>



        <div class="modal-overlay" id="modalOverlay">
            <div class="modal" style="padding-left: 5px;padding-right: 5px;padding-bottom: 5px;padding-top: 5px;background: white;">

                <button class="buttonbell" id="closeModalBtn" style="padding-top: 4px;padding-bottom: 4px;">
                    <svg class="bell" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="color: white;">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path>
                    </svg>


                </button>
                <div class="card">
                    <span class="title">Создать заявку</span>
                    <form class="formT" method="post" enctype="multipart/form-data" action="{% url 'create_ticket' %}">
                        {% csrf_token %}
                        <div class="group" style="height: 59px;">
                            <label class="select" for="slct" style="top: 0px;left: 0px;bottom: 0px;right: 0px;">
                                <select id="service" name="service" required="required">
                                    <option value="" disabled="disabled" selected="selected">Выберите услугу</option>


                                </select>
                                <svg style="top: 15px;">
                                    <use xlink:href="#select-arrow-down"></use>
                                </svg>
                            </label>
                            <!-- SVG Sprites-->
                            <svg class="sprites">
                                <symbol id="select-arrow-down" viewBox="0 0 10 6">
                                    <polyline points="1 1 5 5 9 1"></polyline>
                                </symbol>
                            </svg>
                        </div>

                        <div class="group" style="height: 59px;">
                            <label class="select" for="slct" style="top: 0px;left: 0px;bottom: 0px;right: 0px;">
                                <select id="component" name="component" disabled required="required">
                                    <option value="">-- Сначала выберите услугу --</option>
                                </select>
                                <svg style="top: 15px;">
                                    <use xlink:href="#select-arrow-down"></use>
                                </svg>
                            </label>
                            <!-- SVG Sprites-->
                            <svg class="sprites">
                                <symbol id="select-arrow-down" viewBox="0 0 10 6">
                                    <polyline points="1 1 5 5 9 1"></polyline>
                                </symbol>
                            </svg>
                        </div>

                        <div class="group">
                            <input placeholder="‎" type="text" name="title" id="title" required>
                            <label for="title">Тема</label>
                        </div>

                        <div class="group">
                            <textarea placeholder="‎" id="comment" name="comment" rows="5" required></textarea>
                            <label for="comment">Описание</label>
                        </div>

                        <label for="file-input" class="drop-container" style="margin-top: 0px;margin-bottom: 20px;">
                            <span class="drop-title">Поместите файлы сюда</span>или
                            <input type="file" name="attachments" multiple id="file-input">
                        </label>

                        <button type="submit" style="margin-left: 0px;">Создать</button>
                    </form>
                </div>

            </div>
        </div>


        <div class="modal-overlay" id="modalOverlay3">
            <div class="modal" style="padding-left: 5px;padding-right: 5px;padding-bottom: 5px;padding-top: 5px;background: white;">

                <button class="buttonbell" id="closeModal3Btn" style="padding-top: 4px;padding-bottom: 4px;">
                    <svg class="bell" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="color: white;">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path>
                    </svg>


                </button>


            </div>
        </div>












        <button class="mode-switch" title="Switch Theme" style="margin-left: 0px;">
            <svg class="moon" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="24" height="24" viewBox="0 0 24 24">
                <defs></defs>
                <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
            </svg>
        </button>

        <div class="list-container" style="z-index: 2;">
            <button class="more-button" aria-label="Menu Button">
                <div class="menu-icon-wrapper">
                    <div class="menu-icon-line half first"></div>
                    <div class="menu-icon-line"></div>
                    <div class="menu-icon-line half last"></div>
                </div>
            </button>
            <ul class="more-button-list" style="">
                <li class="more-button-list-item">
                    <a href="/" class="more-button-list-item" style="padding: 0;text-decoration: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5" class="size-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"></path>
                        </svg>

                        <span>Главная</span>
                    </a>
                </li>

                <li class="more-button-list-item">
                    <a id="openModal2Btn" class="more-button-list-item" style="padding: 0;text-decoration: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 17.25v1.007a3 3 0 0 1-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0 1 15 18.257V17.25m6-12V15a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 15V5.25m18 0A2.25 2.25 0 0 0 18.75 3H5.25A2.25 2.25 0 0 0 3 5.25m18 0V12a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 12V5.25"></path>
                        </svg>

                        <span>Мои КЕ</span>
                    </a>
                </li>
                <li class="more-button-list-item">
                    <a href="/logout/" class="more-button-list-item" style="padding: 0;text-decoration: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"></path>
                        </svg>


                        <span>Выход</span>
                    </a>
                </li>

            </ul>
        </div>
    </div>

    <button class="messages-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-message-circle">
            <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>
        </svg>
    </button>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="{% static 'app/js/header_script.js' %}"></script>
<script>
    var preferredTheme = "{{theme}}"; // например, "dark" или "light"

    var modeSwitch = document.querySelector('.mode-switch');

    // Применяем тему при загрузке страницы
    if (preferredTheme === 'dark') {
        document.documentElement.classList.add('dark');
        modeSwitch.classList.add('active');
    } else {
        document.documentElement.classList.remove('dark');
        modeSwitch.classList.remove('active');
    }

    // Обработка переключения темы
    modeSwitch.addEventListener('click', function () {
        document.documentElement.classList.toggle('dark');
        modeSwitch.classList.toggle('active');

        // Получаем новую тему после переключения
        var newTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';

         //Отправляем AJAX-запрос на сервер для сохранения нового значения
        fetch("{% url 'set_theme' %}", {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': '{{ csrf_token }}'
            },
            body: JSON.stringify({ theme: newTheme })
        });
    });
</script>